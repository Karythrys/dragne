(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))O(i);new MutationObserver(i=>{for(const f of i)if(f.type==="childList")for(const w of f.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&O(w)}).observe(document,{childList:!0,subtree:!0});function b(i){const f={};return i.integrity&&(f.integrity=i.integrity),i.referrerPolicy&&(f.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?f.credentials="include":i.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function O(i){if(i.ep)return;i.ep=!0;const f=b(i);fetch(i.href,f)}})();const o=40,K=3,U=.01;class c{x;y;constructor(a,b){this.x=a,this.y=b}}async function N(y){const a=y.getContext("2d",{alpha:!0}),b=document.querySelector("#eaten"),O=document.querySelector("#longnehead"),i=document.querySelector("#longnelegs"),f=document.querySelector("#longnetail"),w=document.querySelector("#longneturn"),F=document.querySelector("#smork"),I=document.querySelector("#orange"),G=document.querySelector("#dragneghost"),H=document.querySelector("#restart");let E=performance.now(),P=E,u=1,k=1,q=0,M=!1,$=1,A=!1,L=!1;const d=Array(Math.floor(y.width/o)).fill("").map(()=>Array(Math.floor(y.height/o)).fill("").map(()=>!1)),m=[new c((d.at(0)?.length??0)>>1,d.length>>1),new c(((d.at(0)?.length??0)>>1)+1,d.length>>1)];function S(e){return new c(e.x*o,e.y*o)}function C(){const e=Math.floor(Math.random()*(d.at(0)?.length??0)),t=Math.floor(Math.random()*d.length);return e===m.at(0)?.x&&t===m.at(0)?.y?new c(e>0?e-1:e+1,t):new c(e,t)}function W(e){if(!d.at(e.y)?.at(e.x))return!1;M=!0,q++,b.innerText=`${q}`,$=Math.log(q+1)+1,d[e.y][e.x]=!1;const t=C();return d[t.y][t.x]=!0,!0}function v(e,t){return e.x===t.x-1&&e.y===t.y?1:e.x===t.x&&e.y===t.y-1?2:e.x===t.x+1&&e.y===t.y?3:e.x===t.x&&e.y===t.y+1?4:0}function _(e,t){if(t===0||t===e.length-1)return 0;const g=e.at(t-1),h=e.at(t),n=e.at(t+1),s=v(h,g),r=v(h,n);return s===1&&r===3?1:s===2&&r===4?2:s===3&&r===1?3:s===4&&r===2?4:s===4&&r===1||r===4&&s===1?-1:s===2&&r===1||r===2&&s===1?-2:s===2&&r===3||r===2&&s===3?-3:s===4&&r===3||r===4&&s===3?-4:0}function x(e,t){if(e===3)return a?.rotate(0);a?.translate(t.x+(o>>1),t.y+(o>>1)),e===4&&a?.rotate(Math.PI*.5),e===1&&a?.rotate(Math.PI),e===2&&a?.rotate(Math.PI*1.5),a?.translate(-(t.x+(o>>1)),-(t.y+(o>>1)))}function j(e){if(e.length<2)throw new Error;const t=e.at(0);if(t===void 0)throw new Error;const g=S(t),h=v(e.at(1),t);x(h,g),a?.drawImage(M?F:O,g.x,g.y,o,o),a?.setTransform(1,0,0,1,0,0);for(let p=1;p<e.length-1;p++){const D=e.at(p);if(D===void 0)throw new Error;const l=S(D),T=_(e,p);switch(T){case-1:{x(1,l),a?.drawImage(w,l.x,l.y,o,o);break}case-2:{x(2,l),a?.drawImage(w,l.x,l.y,o,o);break}case-3:{x(3,l),a?.drawImage(w,l.x,l.y,o,o);break}case-4:{x(4,l),a?.drawImage(w,l.x,l.y,o,o);break}default:{if(T===0)break;x(T,l),a?.drawImage(i,l.x,l.y,o,o);break}}a?.setTransform(1,0,0,1,0,0)}const n=e.at(e.length-1);if(n===void 0)throw new Error;const s=S(n),r=v(n,e.at(e.length-2));x(r,s),a?.drawImage(f,s.x,s.y,o,o),a?.setTransform(1,0,0,1,0,0)}function z(e){for(let t=0;t<e.length;t++)for(let g=0;g<(e.at(t)?.length??0);g++)if(e.at(t)?.at(g)){const h=S(new c(g,t));a?.drawImage(I,0,-4,I.width+8,(I.height>>1)+8,h.x+(o>>2),h.y+(o>>2),o>>1,o>>1)}}for(let e=0;e<K;e++){const t=C();d.at(t.y)?.at(t.x)===!1?d[t.y][t.x]=!0:e--}window.addEventListener("keydown",e=>{switch(e.key){case"d":case"D":case"ArrowRight":{u=1;break}case"w":case"W":case"ArrowUp":{u=2;break}case"a":case"A":case"ArrowLeft":{u=3;break}case"s":case"S":case"ArrowDown":{u=4;break}}}),H.addEventListener("click",()=>{L=!0});function R(e){if(L){L=!1,N(y);return}const t=(e-E)/1e3,g=(e-P)/1e3,h=1/$;if(!A&&g>h){P=e;const n=m.at(0);if(n===void 0)throw new Error;const s=v(m.at(1),n);let r;switch(s){case 1:{if(u===2){r=new c(n.x,n.y-1);break}if(u===4){r=new c(n.x,n.y+1);break}r=new c(n.x+1,n.y);break}case 2:{if(u===1){r=new c(n.x+1,n.y);break}if(u===3){r=new c(n.x-1,n.y);break}r=new c(n.x,n.y+1);break}case 3:{if(u===2){r=new c(n.x,n.y-1);break}if(u===4){r=new c(n.x,n.y+1);break}r=new c(n.x-1,n.y);break}case 4:{if(u===1){r=new c(n.x+1,n.y);break}if(u===3){r=new c(n.x-1,n.y);break}r=new c(n.x,n.y-1);break}}if(r===void 0)throw new Error;r.x<0||r.x>=(d.at(0)?.length??0)||r.y<0||r.y>=d.length||m.findIndex(p=>p.x===r.x&&p.y===r.y)!==-1?A=!0:(M=!1,m.unshift(r),W(r)||m.pop())}if(a?.clearRect(0,0,y.width,y.height),j(m),z(d),A){k<4&&(k+=U*t),k>=4&&(k=4);const n=o*k;a?.drawImage(G,(y.width>>1)-n/2,(y.height>>1)-n/2,n,n)}setTimeout(()=>requestAnimationFrame(R),10)}R(E)}const Z="/longnehead.png",B="/longnelegs.png",J="/longneneck.png",Q="/longnetail.png",V="/longneturn.png",X="/smork.png",Y="/orange.svg",ee="/dragneghost.webp";window.addEventListener("load",()=>{document.querySelector("#app").innerHTML=`
        <div style="display: none;" >
            <img id="longnehead" src=${Z} >
            <img id="longnelegs" src=${B} >
            <img id="longneneck" src=${J} >
            <img id="longnetail" src=${Q} >
            <img id="longneturn" src=${V} >
            <img id="smork" src=${X} >
            <img id="orange" src=${Y} >
            <img id="dragneghost" src=${ee} >
        </div>
        <div style="border: 1px solid black; background-color: teal; padding: 8px; display: flex; flex-direction: row; justify-content: space-between;" >
            <div style="display: flex; flex-direction: column; align-items: start;" >
                <div>Oranges eaten: <span id="eaten">0</span></div>
                <div>WASD or arrow keys to navigate.</div>
            </div>
            <button id="restart">Restart</button>
        </div>
        <canvas id="dragne-game" width="520" height="520" style="border: 1px solid blue" ></canvas>
    `,N(document.querySelector("#dragne-game"))});
